# Описание проекта

Нужно создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения. Под риском понимается вероятность ДТП с любым повреждением транспортного средства. Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту.

Идея создания такой системы находится в стадии предварительного обсуждения и проработки. Чёткого алгоритма работы и подобных решений на рынке ещё не существует. Текущая задача — понять, возможно ли предсказывать ДТП, опираясь на исторические данные одного из регионов.

Идея решения задачи от заказчика:

1.  Создать модель предсказания ДТП (целевое значение — `at_fault` (виновник) в таблице `parties`)
    
    - Для модели выбрать тип виновника — только машина (`car`).
    - Выбрать случаи, когда ДТП привело к любым повреждениям транспортного средства, кроме типа `SCRATCH` (царапина).
    - Для моделирования ограничиться данными за `2012` год — они самые свежие.
    - Обязательное условие — учесть фактор возраста автомобиля.
2.  На основе модели исследовать основные факторы ДТП.
    
3.  Понять, помогут ли результаты моделирования и анализ важности факторов ответить на вопросы:
    
    - Возможно ли создать адекватную системы оценки водительского риска при выдаче авто?
    - Какие ещё факторы нужно учесть?
    - Нужно ли оборудовать автомобиль какими-либо датчиками или камерой

**Краткое описание таблиц**

- `collisions` — общая информация о ДТП  
    Имеет уникальный `case_id`. Эта таблица описывает общую информацию о ДТП. Например, где оно произошло и когда.
- `parties` — информация об участниках ДТП  
    Имеет неуникальный `case_id`, который сопоставляется с соответствующим ДТП в таблице `collisions`. Каждая строка здесь описывает одну из сторон, участвующих в ДТП. Если столкнулись две машины, в этой таблице должно быть две строки с совпадением `case_id`. Если нужен уникальный идентификатор, это `case_id` and `party_number`.
- `vehicles` — информация о пострадавших машинах  
    Имеет неуникальные `case_id` и неуникальные `party_number`, которые сопоставляются с таблицей `collisions` и таблицей `parties`. Если нужен уникальный идентификатор, это `case_id` and `party_number`.

# Вывод

В результате исследования были выполнены следующие этапы:

1.  Загрузка таблиц `SQL`.
    
2.  Статистический анализ факторов ДТП (10 аналитических задач).
    
3.  Создан датасет исходя из пожеланий заказчика.
    
    - Тип виновника — только машина (`car`).
    - Cлучаи, когда ДТП привело к любым значимым повреждениям автомобиля любого из участников — все, кроме типа `SCRATCH` (царапина).
    - Для моделирования берутся данные только за 2012 год.
    - Обязательное условие — учесть фактор возраста автомобиля.
    - Подготовка исходной таблицы осуществляется с помощью sql-запроса.
4.  Проведена предобработка данных и иследовательский анализ.
    
5.  Обучены несколько моделей с перебором гиперпараметров и кроссвалидацией.
    

Лучшая модель - Лучшая модель это `CatBoostClassifier`. `F1` на тестовой выборке - **0.6916**.

- всего предсказаний: **11250**;
- правильно предсказанные ответы: **71.09%**;
- ошибки в прогнозах: **28.91%**;
- `Recall`: **64.25%**;
- `Precision`: **74.88%**;

Самое большое влияние на модель оказывают:

- `distance` - расстояние от главной дороги (метры или дюймы) - 31.94%. Удаленность от главной дороги действительно может влиять.
- `lighting` - освещение - 30.96%, это существенный фактор. Освещение прямо влияет на возможность аварии.

К сожалению информация по 2012 году не полная по случаям ДТП. После июня очень мало случаев. Возможмо улучшить метрику можно сделав тренировочную выборку за 2011 год с выделением месяца и веремени ДТП, а тестировать на 2012 году. Но условие заказчика был 2012 год...

Рекомендации:

Т.к. в БД и соответсвенно в датасете очень много данных, которые описывают уже свершившийся факт нужно доработать БД.

Необходимо добавлять в БД и датасет личностные характерискики водителя, которых в базе нету.

Эти характеристики будут прямо влиять на вероятность ппопадания и в ДТП и виновности/не виновности в ДТП.

Могут помочь следующие характеристики:

- возраст водителя,
- стаж водителя,
- количество нарушений за все время (тип, кол-во),
- попадал ли в аварии,
- количество ДТП, если попадал в аварии,
- количество раз, когда быда признана вина в ДТП.
- опционально: прочие нарушения не за рулем(административки за нахождение в нетрезвом виде, характеристика личности если таковая ведется при вынесение адпинистративных штрафов и т.п.).

# Статус

Проект завершён.
